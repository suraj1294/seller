(this["webpackJsonpfuse-react-app"]=this["webpackJsonpfuse-react-app"]||[]).push([[12],{1417:function(e,t,a){"use strict";var n=a(55),r=a.n(n),c=a(36),o=a(96),i="[E-COMMERCE APP] GET PRODUCTS",s="[E-COMMERCE APP] SET PRODUCTS SEARCH TEXT";function l(e){var t;return t=r.a.get(o.a+"/product?createdBy="+e),function(e){return t.then((function(t){e({type:i,payload:t.data})}))}}function u(e,t){var a=r.a.post(o.a+"/product/updatestatus",e);return function(e){a.then((function(a){e(Object(c.B)({message:"Status Updated"})),e(l(t))}))}}function d(e,t){var a=r.a.post(o.a+"/product/updateapprove",e);return function(e){a.then((function(a){e(Object(c.B)({message:"Status Updated"})),e(l(t))}))}}function p(e){return{type:s,searchText:e.target.value}}var h=a(10),f="[E-COMMERCE APP] GET PRODUCT",m="[E-COMMERCE APP] SAVE PRODUCT",g="[E-COMMERCE APP] GET CATS";function E(e){var t=e.productId,a=r.a.get(o.a+"/product/"+t);return function(e){return a.then((function(t){e({type:f,payload:t.data[0]})}))}}function b(e){var t=r.a.get(o.a+"/productcategory?listingType="+e);return function(e){return t.then((function(t){var a=t.data.map((function(e){return{value:e.name,label:e.name}}));e({type:g,payload:a})}))}}function y(e){var t=r.a.post(o.a+"/product/create",e);return function(e){return t.then((function(t){return e(Object(c.B)({message:"Product Saved"})),e(function(e){var t=r.a.post(o.a+"/dashboard/create",{productId:e._id,productOwnerId:e.createdBy,analytic:"PRODUCT_ADDED"});return function(e){return t.then((function(t){return e({type:"TES-TST",payload:t.data})}))}}(t.data)),e({type:m,payload:t.data})}))}}function O(e){var t=r.a.put(o.a+"/product/"+e._id,e);return function(e){return t.then((function(t){return e(Object(c.B)({message:"Product Saved"})),e({type:m,payload:t.data})}))}}function P(e){var t={id:h.v.generateGUID(),uuid:e,name:"",handle:"",description:"",categories:[],tags:[],images:[],price:"",listingType:"service",starRating:0,discount:5,quantity:0,sku:"",width:"",height:"",depth:"",weight:"",status:1};return{type:f,payload:t}}var v="[E-COMMERCE APP] GET CATEGORIES",w="[E-COMMERCE APP] SET CATEGORIES SEARCH TEXT";var S="[E-COMMERCE APP] GET CATEGORY",C="[E-COMMERCE APP] SAVE CATEGORY";a.d(t,"f",(function(){return i})),a.d(t,"j",(function(){return s})),a.d(t,"a",(function(){return"[E-COMMERCE APP] SET PRODUCTS SEARCH TEXT"})),a.d(t,"o",(function(){return l})),a.d(t,"k",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"s",(function(){return p})),a.d(t,"e",(function(){return f})),a.d(t,"h",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"n",(function(){return E})),a.d(t,"m",(function(){return b})),a.d(t,"r",(function(){return y})),a.d(t,"q",(function(){return O})),a.d(t,"p",(function(){return P})),a.d(t,"b",(function(){return v})),a.d(t,"i",(function(){return w})),a.d(t,"c",(function(){return S})),a.d(t,"g",(function(){return C}))},1421:function(e,t,a){"use strict";var n=a(17),r=a(9),c=a(1417);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s={data:[],searchText:""},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.f:return i({},e,{data:t.payload});case c.j:return i({},e,{searchText:t.searchText});case c.a:return i({},e,{data:t.payload});default:return e}};function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={data:null,categories:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.e:case c.h:return d({},e,{data:t.payload});case c.d:return d({},e,{categories:t.payload});default:return e}};function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={data:[],searchText:""},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.b:return m({},e,{data:t.payload});case c.i:return m({},e,{searchText:t.searchText});default:return e}};function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={data:null},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.c:case c.g:return y({},e,{data:t.payload});default:return e}},v=Object(n.d)({products:l,product:h,categories:E,category:P});t.a=v},1469:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a(394),i=a(11),s=a(12),l=a(15),u=a(14),d=a(16),p=a(2),h=a(78),f=a(17),m=a(30),g=a(4),E=a.n(g),b=a(6),y=a(52),O=[{id:"name",align:"left",disablePadding:!1,label:"Name",sort:!0},{id:"categories",align:"left",disablePadding:!1,label:"Category",sort:!0},{id:"price",align:"left",disablePadding:!1,label:"Price(OMR)",sort:!0},{id:"quantity",align:"right",disablePadding:!1,label:"Quantity",sort:!0},{id:"view",align:"center",disablePadding:!1,label:"View",sort:!0},{id:"status",align:"right",disablePadding:!1,label:"Status",sort:!0},{id:"action",align:"center",disablePadding:!1,label:"Action",sort:!0}],P=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={selectedProductsMenu:null},a.createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a.openSelectedProductsMenu=function(e){a.setState({selectedProductsMenu:e.currentTarget})},a.closeSelectedProductsMenu=function(){a.setState({selectedProductsMenu:null})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.order,n=t.orderBy;return r.a.createElement(p.X,null,r.a.createElement(p.Z,{className:"h-64"},O.map((function(t){return r.a.createElement(p.W,{key:t.id,align:t.align,padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},t.sort&&r.a.createElement(p.eb,{title:"Sort",placement:"right"===t.align?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement(p.ab,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))}),this)))}}]),t}(r.a.Component),v=Object(y.withStyles)((function(e){return{actionsButtonWrapper:{background:e.palette.background.paper}}}),{withTheme:!0})(P),w=a(173),S=a.n(w),C=a(200),j=a.n(C),T=a(204),x=a.n(T),A=a(202),k=a.n(A),D=a(203),R=a.n(D),M=a(201),N=a.n(M),I=a(207),B=a(1417),_=a(160),q=a.n(_),U=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:null,selected:[],data:a.props.products,page:0,rowsPerPage:10,anchorEl:null,open:!1,productId:""},a.handleAgree=function(){a.setState({open:!1}),a.props.changeStatus({productId:a.state.productId,status:parseInt(a.state.status)>=1?0:1},a.props.user._id)},a.handleDisAgree=function(){a.setState({open:!1})},a.handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(e){a.setState({anchorEl:null})},a.handleCloseMenu=function(e){a.setState({anchorEl:null})},a.handleClickAction=function(e){e.preventDefault(),a.setState({open:!0,productId:e.currentTarget.dataset.productid,status:e.currentTarget.dataset.status})},a.handleAdmin=function(e){a.setState({status:e.currentTarget.dataset.status}),a.props.changeStatusAdmin({productId:a.state.productId,status:parseInt(e.currentTarget.dataset.status)},a.props.user._id),a.setState({anchorEl:null})},a.selectedSme=function(e){a.setState({productId:e})},a.handleClickActionAdmin=function(e){a.setState({anchorEl:e.currentTarget})},a.getFilteredArray=function(e,t){return 0===t.length?e:b.a.filter(e,(function(e){return e.name.toLowerCase().includes(t.toLowerCase())}))},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleSelectAllClick=function(e){e.target.checked?a.setState((function(e){return{selected:a.state.data.map((function(e){return e.id}))}})):a.setState({selected:[]})},a.handleClick=function(e){a.props.history.push("/apps/product/edit/"+e._id)},a.handleClickBuyer=function(e){window.location.href=I.a+"/Product?id="+e._id},a.handleCheck=function(e,t){var n=a.state.selected,r=n.indexOf(t),c=[];-1===r?c=c.concat(n,t):0===r?c=c.concat(n.slice(1)):r===n.length-1?c=c.concat(n.slice(0,-1)):r>0&&(c=c.concat(n.slice(0,r),n.slice(r+1))),a.setState({selected:c})},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.getProducts(q.a.get("userId"))}},{key:"componentDidUpdate",value:function(e,t){if(!b.a.isEqual(this.props.products,e.products)||!b.a.isEqual(this.props.searchText,e.searchText)){var a=this.getFilteredArray(this.props.products,this.props.searchText);this.setState({data:a})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.order,n=t.orderBy,o=t.selected,i=t.rowsPerPage,s=t.page,l=t.data,u=this.props.user;return r.a.createElement("div",{className:"w-full flex flex-col"},r.a.createElement(c.o,{className:"flex-grow overflow-x-auto"},r.a.createElement(p.U,{className:"min-w-xl","aria-labelledby":"tableTitle"},r.a.createElement(v,{numSelected:o.length,order:a,orderBy:n,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:l.length,user:this.props.user}),r.a.createElement(p.V,null,b.a.orderBy(l,[function(e){switch(n){case"categories":return e.categories[0];default:return e[n]}}],[a]).slice(s*i,s*i+i).map((function(t){var a=e.isSelected(t.id);return r.a.createElement(p.Z,{className:"h-64 cursor-pointer",hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:t._id,selected:a},r.a.createElement(p.W,{component:"th",scope:"row"},t.name),r.a.createElement(p.W,{className:"truncate",component:"th",scope:"row"},t.categories.join(", ")),r.a.createElement(p.W,{component:"th",scope:"row",align:"left"},t.price),r.a.createElement(p.W,{component:"th",scope:"row",align:"right"},t.quantity,r.a.createElement("i",{className:E()("inline-block w-8 h-8 rounded ml-8",t.quantity<=5&&"bg-red",t.quantity>5&&t.quantity<=25&&"bg-orange",t.quantity>25&&"bg-green")})),r.a.createElement(p.W,{component:"th",scope:"row",align:"right"},r.a.createElement("a",{onClick:function(a){return e.handleClick(t)}},"Edit/"),r.a.createElement("a",{onClick:function(a){return e.handleClickBuyer(t)}}," View ")),r.a.createElement(p.W,{component:"th",scope:"row",align:"right"},t.status?r.a.createElement(p.u,{className:"text-green text-20"},"check_circle"):r.a.createElement(p.u,{className:"text-red text-20"},"remove_circle")),u&&"sme"!==u.role&&r.a.createElement(p.W,{component:"th",scope:"row",align:"right"},2===t.approveStatus?r.a.createElement(p.u,{className:"text-yellow text-20"},"remove_circle"):1===t.approveStatus?r.a.createElement(p.u,{className:"text-green text-20"},"check_circle"):r.a.createElement(p.u,{className:"text-red text-20"},"remove_circle")),r.a.createElement(p.W,{component:"th",scope:"row",align:"center"},r.a.createElement("div",null,r.a.createElement(S.a,{"aria-owns":"simple-menu","aria-haspopup":"true",onClick:e.handleClickAction,"data-productid":t._id,"data-status":t.status},t.status?"DeActivate":"Activate"))))}))))),r.a.createElement(p.Y,{component:"div",count:l.length,rowsPerPage:i,page:s,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),r.a.createElement(j.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(N.a,{id:"alert-dialog-title"},"Action Alert!"),r.a.createElement(k.a,null,r.a.createElement(R.a,{id:"alert-dialog-description"},"This action will change the current status of Product. Do you want to proceed with action?")),r.a.createElement(x.a,null,r.a.createElement(S.a,{onClick:this.handleDisAgree,variant:"contained",color:"primary"},"Disagree"),r.a.createElement(S.a,{onClick:this.handleAgree,variant:"contained",color:"primary",autoFocus:!0},"Agree"))))}}]),t}(n.Component);var W=Object(h.g)(Object(m.a)((function(e){var t=e.ProductsApp,a=e.auth;return{products:t.products.data,searchText:t.products.searchText,user:a.user}}),(function(e){return Object(f.c)({getProducts:B.o,changeStatus:B.k,changeStatusAdmin:B.l},e)}))(U)),G=a(21),H=a(22);var L=Object(G.b)((function(e){var t=e.ProductsApp,a=e.fuse,n=e.auth;return{searchText:t.products.searchText,mainTheme:a.settings.mainTheme,user:n.user}}),(function(e){return Object(f.c)({setSearchText:B.s},e)}))((function(e){var t=e.setSearchText,a=e.searchText,n=e.mainTheme,o=e.user;return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(c.a,{animation:"transition.expandIn",delay:300},r.a.createElement(p.u,{className:"text-32 mr-0 sm:mr-12"},"shopping_basket")),r.a.createElement(c.a,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(p.fb,{className:"hidden sm:flex",variant:"h6"},"My Listings"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"},r.a.createElement(y.MuiThemeProvider,{theme:n},r.a.createElement(c.a,{animation:"transition.slideDownIn",delay:300},r.a.createElement(p.J,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},r.a.createElement(p.u,{className:"mr-8",color:"action"},"search"),r.a.createElement(p.w,{placeholder:"Search",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:a,inputProps:{"aria-label":"Search"},onChange:t}))))),o&&"sme"==o.role&&r.a.createElement(c.a,{animation:"transition.slideRightIn",delay:300},r.a.createElement(p.c,{component:H.a,to:"/apps/product/new",className:"whitespace-no-wrap",variant:"contained"},r.a.createElement("span",{className:"hidden sm:flex"},"Add New Listing"),r.a.createElement("span",{className:"flex sm:hidden"},"New"))))})),V=a(1421);t.default=Object(o.a)("ProductsApp",V.a)((function(){return r.a.createElement(c.m,{classes:{content:"flex",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(L,null),content:r.a.createElement(W,null),innerScroll:!0})}))}}]);