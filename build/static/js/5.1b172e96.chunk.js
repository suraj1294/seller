(this["webpackJsonpfuse-react-app"]=this["webpackJsonpfuse-react-app"]||[]).push([[5],{1418:function(e,t,a){"use strict";var n=a(55),r=a.n(n),c=a(23),o=a(96),l="[E-COMMERCE APP] GET ORDERS",i="[E-COMMERCE APP] SET ORDERS SEARCH TEXT";function s(e){var t=r.a.get(o.a+"/enquiry/getinbox?uuid="+e);return function(e){return t.then((function(t){e({type:l,payload:t.data})}))}}function d(e){var t=r.a.get(o.a+"/enquiry/getoutbox?uuid="+e);return function(e){return t.then((function(t){e({type:l,payload:t.data})}))}}function u(e,t){return function(a){r.a.put(o.a+"/enquiry/updatestatus",e).then((function(e){e.data&&(a(s(t)),a(Object(c.j)({message:"Status Updated!"})))}))}}function p(e){return{type:i,searchText:e.target.value}}var h=a(36),f="[E-COMMERCE APP] GET ORDER",m="[E-COMMERCE APP] SAVE ORDER";function g(e,t){var a=r.a.get(o.a+"/enquiry/"+e.orderId);return function(e){return a.then((function(t){e({type:f,payload:t.data&&t.data.length?t.data[0]:[]})}))}}function b(e,t,a){return function(n){r.a.post(o.a+"/enquiry/replychat",{id:t,reply:{chatText:e,userId:a,chatDate:""}}).then((function(e){n(Object(h.B)({message:"Comment Added"})),n(g({orderId:t}))}))}}function E(e){var t=r.a.post(o.a+"/api/e-commerce-app/order/save",e);return function(e){return t.then((function(t){return e(Object(h.B)({message:"Enquiry Saved"})),e({type:m,payload:t.data})}))}}a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"h",(function(){return s})),a.d(t,"i",(function(){return d})),a.d(t,"f",(function(){return u})),a.d(t,"k",(function(){return p})),a.d(t,"a",(function(){return f})),a.d(t,"c",(function(){return m})),a.d(t,"g",(function(){return g})),a.d(t,"e",(function(){return b})),a.d(t,"j",(function(){return E}))},1419:function(e,t,a){"use strict";var n=a(3);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),c=n(a(87)),o=n(a(68));var l=function(e,t){var a=function(t){return r.default.createElement(o.default,t,e)};return a.displayName="".concat(t,"Icon"),(a=(0,c.default)(a)).muiName="SvgIcon",a};t.default=l},1420:function(e,t,a){"use strict";var n=a(3);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),c=(0,n(a(1419)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.default.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"})),"ArrowDownward");t.default=c},1422:function(e,t,a){"use strict";var n=a(17),r=a(9),c=a(1418);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var i={data:[],searchText:""},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.b:return l({},e,{data:t.payload});case c.d:return l({},e,{searchText:t.searchText});default:return e}};function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.a:case c.c:return u({},t.payload);default:return e}},h=Object(n.d)({orders:s,order:p});t.a=h},1423:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(4),o=a.n(c),l=a(6),i=[{id:3,name:"Delivered",color:"bg-green-dark text-white"},{id:4,name:"Declined",color:"bg-red-dark text-white"},{id:1,name:"Pending",color:"bg-purple-light text-white"},{id:2,name:"Processed",color:"bg-blue text-white"}];t.a=function(e){var t=e.name;return r.a.createElement("div",{className:o()("inline text-12 p-4 rounded truncate",l.a.find(i,{id:t}).color)},l.a.find(i,{id:t}).name)}},1467:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a(394),l=a(2),i=a(52),s=a(1418),d=a(17),u=a(21);var p=Object(u.b)((function(e){var t=e.eCommerceApp,a=e.fuse;return{searchText:t.orders.searchText,mainTheme:a.settings.mainTheme}}),(function(e){return Object(d.c)({setSearchText:s.k},e)}))((function(e){var t=e.setSearchText,a=e.searchText,n=e.mainTheme;return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(c.a,{animation:"transition.expandIn",delay:300},r.a.createElement(l.u,{className:"text-32 mr-0 sm:mr-12"},"shopping_basket")),r.a.createElement(c.a,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(l.fb,{className:"hidden sm:flex",variant:"h6"},"Enquiry"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center pr-0 pl-12 sm:px-12"},r.a.createElement(i.MuiThemeProvider,{theme:n},r.a.createElement(c.a,{animation:"transition.slideDownIn",delay:300},r.a.createElement(l.J,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},r.a.createElement(l.u,{className:"mr-8",color:"action"},"search"),r.a.createElement(l.w,{placeholder:"Search",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:a,inputProps:{"aria-label":"Search"},onChange:t}))))))})),h=a(11),f=a(12),m=a(15),g=a(14),b=a(16),E=a(1420),y=a.n(E),v=a(78),O=a(30),P=a(6),w=[{id:"reference",align:"left",disablePadding:!1,label:"Buyer",sort:!0},{id:"customer",align:"left",disablePadding:!1,label:"Description",sort:!0},{id:"view",align:"left",disablePadding:!1,label:"View",sort:!0},{id:"status",align:"left",disablePadding:!1,label:"Status",sort:!0},{id:"action",align:"left",disablePadding:!1,label:"Action",sort:!0}],S=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={selectedOrdersMenu:null},a.createSortHandler=function(e){return function(t){a.props.onRequestSort(t,e)}},a.openSelectedOrdersMenu=function(e){a.setState({selectedOrdersMenu:e.currentTarget})},a.closeSelectedOrdersMenu=function(){a.setState({selectedOrdersMenu:null})},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.order,n=t.orderBy;return r.a.createElement(l.X,null,r.a.createElement(l.Z,{className:"h-64"},w.map((function(t){return r.a.createElement(l.W,{key:t.id,align:t.align,padding:t.disablePadding?"none":"default",sortDirection:n===t.id&&a},t.sort&&r.a.createElement(l.eb,{title:"Sort",placement:"right"===t.align?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement(l.ab,{active:n===t.id,direction:a,onClick:e.createSortHandler(t.id)},t.label)))}),this)))}}]),t}(n.Component),C=Object(i.withStyles)((function(e){return{actionsButtonWrapper:{background:e.palette.background.paper}}}),{withTheme:!0})(S),x=a(1423),j=a(173),k=a.n(j),T=a(395),D=a.n(T),A=a(271),M=a.n(A),N=a(200),R=a.n(N),I=a(204),q=a.n(I),B=a(202),_=a.n(B),W=a(203),V=a.n(W),z=a(201),F=a.n(z),H=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"id",selected:[],data:a.props.orders,page:0,rowsPerPage:10,anchorEl:null,open:!1,selectedStatus:"",productId:"",code:""},a.handleAgree=function(){a.setState({open:!1});var e=a.state,t=e.productId,n=(e.selectedStatus,e.code);a.props.changeStatus({enqId:t,status:parseInt(n)},a.props.auth.user._id)},a.handleDisAgree=function(){a.setState({open:!1})},a.handleClickOpen=function(){a.setState({open:!0})},a.handleClickAction=function(e,t){e.preventDefault(),a.setState({anchorEl:e.currentTarget,productId:t})},a.handleClose=function(e){a.setState({anchorEl:null,open:!0,selectedStatus:e.currentTarget.id,code:e.currentTarget.dataset.status})},a.setProd=function(e){a.setState({productId:e})},a.handleCloseMenu=function(e){a.setState({anchorEl:null})},a.getFilteredArray=function(e,t){return 0===t.length?e:c.v.filterArrayByString(e,t)},a.handleRequestSort=function(e,t){var n=t,r="desc";a.state.orderBy===t&&"desc"===a.state.order&&(r="asc"),a.setState({order:r,orderBy:n})},a.handleSelectAllClick=function(e){e.target.checked?a.setState((function(e){return{selected:a.state.data.map((function(e){return e._id}))}})):a.setState({selected:[]})},a.handleClick=function(e){a.props.history.push("/apps/e-commerce/orders/"+e._id)},a.handleCheck=function(e,t){var n=a.state.selected,r=n.indexOf(t),c=[];-1===r?c=c.concat(n,t):0===r?c=c.concat(n.slice(1)):r===n.length-1?c=c.concat(n.slice(0,-1)):r>0&&(c=c.concat(n.slice(0,r),n.slice(r+1))),a.setState({selected:c})},a.handleChangePage=function(e,t){a.setState({page:t})},a.handleChangeRowsPerPage=function(e){a.setState({rowsPerPage:e.target.value})},a.isSelected=function(e){return-1!==a.state.selected.indexOf(e)},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.getOrders(this.props.auth.user._id)}},{key:"componentDidUpdate",value:function(e,t){if(!P.a.isEqual(this.props.orders,e.orders)||!P.a.isEqual(this.props.searchText,e.searchText)){var a=this.getFilteredArray(this.props.orders,this.props.searchText);this.setState({data:a})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.order,n=t.orderBy,o=t.selected,i=t.rowsPerPage,s=t.page,d=t.data,u=t.anchorEl;return r.a.createElement("div",{className:"w-full flex flex-col"},r.a.createElement(c.o,{className:"flex-grow overflow-x-auto"},r.a.createElement(l.U,{className:"min-w-xl","aria-labelledby":"tableTitle"},r.a.createElement(C,{numSelected:o.length,order:a,orderBy:n,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:d.length}),r.a.createElement(l.V,null,P.a.orderBy(d,[function(e){switch(n){case"id":return parseInt(e.id,10);case"customer":return e.customer.firstName;case"payment":return e.payment.method;case"status":return e.status.name;default:return e[n]}}],[a]).slice(s*i,s*i+i).map((function(t,a){var n=e.isSelected(t._id);return r.a.createElement(l.Z,{className:"h-64 cursor-pointer",hover:!0,role:"checkbox","aria-checked":n,tabIndex:-1,key:a,selected:n},r.a.createElement(l.W,{component:"th",scope:"row"},t.sender[0].smeName),r.a.createElement(l.W,{className:"truncate",style:{whiteSpace:"normal",wordWrap:"break-word"},component:"th",scope:"row"},t.enquiry[0].chatText),r.a.createElement(l.W,{component:"th",scope:"row"},r.a.createElement("span",{onClick:function(a){return e.handleClick(t)}},"view")),r.a.createElement(l.W,{component:"th",scope:"row"},r.a.createElement(x.a,{name:t.status})),r.a.createElement(l.W,{component:"th",scope:"row"},r.a.createElement("div",null,r.a.createElement(l.v,{onClick:function(a){return e.handleClickAction(a,t._id)},"aria-label":"delete",size:"small"},r.a.createElement(y.a,{fontSize:"inherit"})),r.a.createElement(D.a,{id:"simple-menu",anchorEl:u,open:Boolean(u),onClose:e.handleCloseMenu},r.a.createElement(M.a,{id:"Pending","data-status":"1","data-productid":t._id,onClick:e.handleClose},"Pending"),r.a.createElement(M.a,{id:"Processed","data-status":"2","data-productid":t._id,onClick:e.handleClose},"Processed"),r.a.createElement(M.a,{id:"Delivered","data-status":"3","data-productid":t._id,onClick:e.handleClose},"Delivered"),r.a.createElement(M.a,{id:"Declined","data-status":"4","data-productid":t._id,onClick:e.handleClose},"Declined")))))}))))),r.a.createElement(l.Y,{component:"div",count:d.length,rowsPerPage:i,page:s,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),r.a.createElement(R.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(F.a,{id:"alert-dialog-title"},"Action Alert!"),r.a.createElement(_.a,null,r.a.createElement(V.a,{id:"alert-dialog-description"},"This action will change the current status of enquiry. Do you want to proceed with action?")),r.a.createElement(q.a,null,r.a.createElement(k.a,{onClick:this.handleDisAgree,variant:"contained",color:"primary"},"Disagree"),r.a.createElement(k.a,{onClick:this.handleAgree,variant:"contained",color:"primary",autoFocus:!0},"Agree"))))}}]),t}(n.Component);var U=Object(v.g)(Object(O.a)((function(e){var t=e.eCommerceApp,a=e.auth;return{orders:t.orders.data,searchText:t.orders.searchText,auth:a}}),(function(e){return Object(d.c)({getOrders:s.h,changeStatus:s.f},e)}))(H)),J=a(1422);t.default=Object(o.a)("eCommerceApp",J.a)((function(){return r.a.createElement(c.m,{classes:{content:"flex",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(p,null),content:r.a.createElement(U,null),innerScroll:!0})}))}}]);