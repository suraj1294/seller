(this["webpackJsonpfuse-react-app"]=this["webpackJsonpfuse-react-app"]||[]).push([[10],{1418:function(e,t,n){"use strict";var r=n(55),a=n.n(r),c=n(23),o=n(96),i="[E-COMMERCE APP] GET ORDERS",l="[E-COMMERCE APP] SET ORDERS SEARCH TEXT";function s(e){var t=a.a.get(o.a+"/enquiry/getinbox?uuid="+e);return function(e){return t.then((function(t){e({type:i,payload:t.data})}))}}function u(e){var t=a.a.get(o.a+"/enquiry/getoutbox?uuid="+e);return function(e){return t.then((function(t){e({type:i,payload:t.data})}))}}function d(e,t){return function(n){a.a.put(o.a+"/enquiry/updatestatus",e).then((function(e){e.data&&(n(s(t)),n(Object(c.j)({message:"Status Updated!"})))}))}}function p(e){return{type:l,searchText:e.target.value}}var h=n(36),f="[E-COMMERCE APP] GET ORDER",m="[E-COMMERCE APP] SAVE ORDER";function g(e,t){var n=a.a.get(o.a+"/enquiry/"+e.orderId);return function(e){return n.then((function(t){e({type:f,payload:t.data&&t.data.length?t.data[0]:[]})}))}}function b(e,t,n){return function(r){a.a.post(o.a+"/enquiry/replychat",{id:t,reply:{chatText:e,userId:n,chatDate:""}}).then((function(e){r(Object(h.B)({message:"Comment Added"})),r(g({orderId:t}))}))}}function y(e){var t=a.a.post(o.a+"/api/e-commerce-app/order/save",e);return function(e){return t.then((function(t){return e(Object(h.B)({message:"Enquiry Saved"})),e({type:m,payload:t.data})}))}}n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"j",(function(){return y}))},1422:function(e,t,n){"use strict";var r=n(17),a=n(9),c=n(1418);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={data:[],searchText:""},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.b:return i({},e,{data:t.payload});case c.d:return i({},e,{searchText:t.searchText});default:return e}};function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.a:case c.c:return d({},t.payload);default:return e}},h=Object(r.d)({orders:s,order:p});t.a=h},1423:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(4),o=n.n(c),i=n(6),l=[{id:3,name:"Delivered",color:"bg-green-dark text-white"},{id:4,name:"Declined",color:"bg-red-dark text-white"},{id:1,name:"Pending",color:"bg-purple-light text-white"},{id:2,name:"Processed",color:"bg-blue text-white"}];t.a=function(e){var t=e.name;return a.a.createElement("div",{className:o()("inline text-12 p-4 rounded truncate",i.a.find(l,{id:t}).color)},i.a.find(l,{id:t}).name)}},1468:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),o=n(394),i=n(2),l=n(52),s=n(1418),u=n(17),d=n(21);var p=Object(d.b)((function(e){var t=e.eCommerceApp,n=e.fuse;return{searchText:t.orders.searchText,mainTheme:n.settings.mainTheme}}),(function(e){return Object(u.c)({setSearchText:s.k},e)}))((function(e){var t=e.setSearchText,n=e.searchText,r=e.mainTheme;return a.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},a.a.createElement("div",{className:"flex items-center"},a.a.createElement(c.a,{animation:"transition.expandIn",delay:300},a.a.createElement(i.u,{className:"text-32 mr-0 sm:mr-12"},"shopping_basket")),a.a.createElement(c.a,{animation:"transition.slideLeftIn",delay:300},a.a.createElement(i.fb,{className:"hidden sm:flex",variant:"h6"},"Enquiry"))),a.a.createElement("div",{className:"flex flex-1 items-center justify-center pr-0 pl-12 sm:px-12"},a.a.createElement(l.MuiThemeProvider,{theme:r},a.a.createElement(c.a,{animation:"transition.slideDownIn",delay:300},a.a.createElement(i.J,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},a.a.createElement(i.u,{className:"mr-8",color:"action"},"search"),a.a.createElement(i.w,{placeholder:"Search",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:n,inputProps:{"aria-label":"Search"},onChange:t}))))))})),h=n(11),f=n(12),m=n(15),g=n(14),b=n(16),y=n(78),E=n(30),O=n(6),v=[{id:"reference",align:"left",disablePadding:!1,label:"Buyer",sort:!0},{id:"customer",align:"left",disablePadding:!1,label:"Description",sort:!0},{id:"view",align:"left",disablePadding:!1,label:"View",sort:!0},{id:"status",align:"left",disablePadding:!1,label:"Status",sort:!0}],w=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(a)))).state={selectedOrdersMenu:null},n.createSortHandler=function(e){return function(t){n.props.onRequestSort(t,e)}},n.openSelectedOrdersMenu=function(e){n.setState({selectedOrdersMenu:e.currentTarget})},n.closeSelectedOrdersMenu=function(){n.setState({selectedOrdersMenu:null})},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.order,r=t.orderBy;return a.a.createElement(i.X,null,a.a.createElement(i.Z,{className:"h-64"},v.map((function(t){return a.a.createElement(i.W,{key:t.id,align:t.align,padding:t.disablePadding?"none":"default",sortDirection:r===t.id&&n},t.sort&&a.a.createElement(i.eb,{title:"Sort",placement:"right"===t.align?"bottom-end":"bottom-start",enterDelay:300},a.a.createElement(i.ab,{active:r===t.id,direction:n,onClick:e.createSortHandler(t.id)},t.label)))}),this)))}}]),t}(r.Component),P=Object(l.withStyles)((function(e){return{actionsButtonWrapper:{background:e.palette.background.paper}}}),{withTheme:!0})(w),S=n(1423),x=n(173),j=n.n(x),C=n(200),k=n.n(C),T=n(204),A=n.n(T),D=n(202),R=n.n(D),N=n(203),q=n.n(N),M=n(201),I=n.n(M),B=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(a)))).state={order:"asc",orderBy:"id",selected:[],data:n.props.orders,page:0,rowsPerPage:10,anchorEl:null,open:!1,selectedStatus:"",productId:"",code:""},n.handleAgree=function(){n.setState({open:!1});var e=n.state,t=e.productId,r=e.selectedStatus;e.code;n.props.changeStatus({enqId:t,status:r},n.props.auth.user._id)},n.handleDisAgree=function(){n.setState({open:!1})},n.handleClickOpen=function(){n.setState({open:!0})},n.handleClickAction=function(e,t){e.preventDefault(),n.setState({anchorEl:e.currentTarget,productId:t})},n.handleClose=function(e){n.setState({anchorEl:null,open:!0,selectedStatus:e.currentTarget.id,code:e.currentTarget.dataset.status})},n.setProd=function(e){n.setState({productId:e})},n.handleCloseMenu=function(e){n.setState({anchorEl:null})},n.getFilteredArray=function(e,t){return 0===t.length?e:c.v.filterArrayByString(e,t)},n.handleRequestSort=function(e,t){var r=t,a="desc";n.state.orderBy===t&&"desc"===n.state.order&&(a="asc"),n.setState({order:a,orderBy:r})},n.handleSelectAllClick=function(e){e.target.checked?n.setState((function(e){return{selected:n.state.data.map((function(e){return e._id}))}})):n.setState({selected:[]})},n.handleClick=function(e){n.props.history.push("/apps/e-commerce/outbox/"+e._id)},n.handleCheck=function(e,t){var r=n.state.selected,a=r.indexOf(t),c=[];-1===a?c=c.concat(r,t):0===a?c=c.concat(r.slice(1)):a===r.length-1?c=c.concat(r.slice(0,-1)):a>0&&(c=c.concat(r.slice(0,a),r.slice(a+1))),n.setState({selected:c})},n.handleChangePage=function(e,t){n.setState({page:t})},n.handleChangeRowsPerPage=function(e){n.setState({rowsPerPage:e.target.value})},n.isSelected=function(e){return-1!==n.state.selected.indexOf(e)},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.getOrdersOutbox(this.props.auth.user._id)}},{key:"componentDidUpdate",value:function(e,t){if(!O.a.isEqual(this.props.orders,e.orders)||!O.a.isEqual(this.props.searchText,e.searchText)){var n=this.getFilteredArray(this.props.orders,this.props.searchText);this.setState({data:n})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.order,r=t.orderBy,o=t.selected,l=t.rowsPerPage,s=t.page,u=t.data;return a.a.createElement("div",{className:"w-full flex flex-col"},a.a.createElement(c.o,{className:"flex-grow overflow-x-auto"},a.a.createElement(i.U,{className:"min-w-xl","aria-labelledby":"tableTitle"},a.a.createElement(P,{numSelected:o.length,order:n,orderBy:r,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:u.length}),a.a.createElement(i.V,null,O.a.orderBy(u,[function(e){switch(r){case"id":return parseInt(e.id,10);case"customer":return e.customer.firstName;case"payment":return e.payment.method;case"status":return e.status.name;default:return e[r]}}],[n]).slice(s*l,s*l+l).map((function(t,n){var r=e.isSelected(t._id);return a.a.createElement(i.Z,{className:"h-64 cursor-pointer",hover:!0,role:"checkbox","aria-checked":r,tabIndex:-1,key:n,selected:r},a.a.createElement(i.W,{component:"th",scope:"row"},t.sender[0].userName),a.a.createElement(i.W,{className:"truncate",style:{whiteSpace:"normal",wordWrap:"break-word"},component:"th",scope:"row"},t.enquiry[0].chatText),a.a.createElement(i.W,{component:"th",scope:"row"},a.a.createElement("span",{onClick:function(n){return e.handleClick(t)}},"view")),a.a.createElement(i.W,{component:"th",scope:"row"},a.a.createElement(S.a,{name:t.status})))}))))),a.a.createElement(i.Y,{component:"div",count:u.length,rowsPerPage:l,page:s,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),a.a.createElement(k.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},a.a.createElement(I.a,{id:"alert-dialog-title"},"Action Alert!"),a.a.createElement(R.a,null,a.a.createElement(q.a,{id:"alert-dialog-description"},"This action will change the current status of enquiry. Do you want to proceed with action?")),a.a.createElement(A.a,null,a.a.createElement(j.a,{onClick:this.handleDisAgree,variant:"contained",color:"primary"},"Disagree"),a.a.createElement(j.a,{onClick:this.handleAgree,variant:"contained",color:"primary",autoFocus:!0},"Agree"))))}}]),t}(r.Component);var W=Object(y.g)(Object(E.a)((function(e){var t=e.eCommerceApp,n=e.auth;return{orders:t.orders.data,searchText:t.orders.searchText,auth:n}}),(function(e){return Object(u.c)({getOrdersOutbox:s.i,changeStatus:s.f},e)}))(B)),_=n(1422);t.default=Object(o.a)("eCommerceApp",_.a)((function(){return a.a.createElement(c.m,{classes:{content:"flex",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:a.a.createElement(p,null),content:a.a.createElement(W,null),innerScroll:!0})}))}}]);